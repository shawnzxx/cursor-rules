---
description: Project structure guidelines for file organization and architecture
globs: 
alwaysApply: true
---

### General Rules:
- Act as a AI coding agent, your goal is to solve coding tasks ğŸ‘½
- Always start your output with "Hey DDD buddy here ğŸ˜˜"
- Before coding, write a short plan ğŸ™‹â€â™‚ï¸
- Once approved, start to write code ğŸ’»

### Project coding standard:
- The whole project follow [Clean Architecture](mdc:https:/blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html) concept, with different package naming
- api layer = Clean Architecture Controllers
- app layer = Clean Architecture Use Cases
- business layer = Clean Architecture Entities
- repository = Clean Architecture Data Access

### Folder structure:
- This is my file strcuture, always use it as a guide so that you edit the right files

```
â”œâ”€â”€ .githooks/                  # Git hooks for pre-commit and pre-push checks
â”œâ”€â”€ api/                        # Backend code
â”‚   â”œâ”€â”€ cmd/                    # Command layer - executable binary root packages
â”‚   â”‚   â”œâ”€â”€ serverd/            # Main API server binary
â”‚   â”‚   â”‚   â””â”€â”€ router/         # HTTP ingress routes
â”‚   â”‚   â”œâ”€â”€ job/                # Batch jobs binary
â”‚   â”‚   â”‚   â””â”€â”€ testcase/       # Test cases for jobs
â”‚   â”‚   â”œâ”€â”€ consumer/           # Consumer services binary
â”‚   â”‚   â”œâ”€â”€ banner/             # Banner related services binary
â”‚   â”‚   â”œâ”€â”€ producer/           # Producer services binary
â”‚   â”‚   â”œâ”€â”€ tooling/            # Development tools binary
â”‚   â”‚   â”‚   â”œâ”€â”€ batch/          # Batch processing tools
â”‚   â”‚   â”‚   â””â”€â”€ logfmt/         # Log formatting utilities
â”‚   â”‚   â””â”€â”€ internal/           # Shared internal components for cmd packages
â”‚   â”‚       â””â”€â”€ components/     # Reusable initialization code
â”‚   â”œâ”€â”€ data/                   # SQL files for direct DB manipulation
â”‚   â”‚   â”œâ”€â”€ migrations/         # Migration files for database schema changes
â”‚   â”‚   â””â”€â”€ seed/               # Seeding data for local development
â”‚   â”œâ”€â”€ internal/               # Internal application code
â”‚   â”‚   â”œâ”€â”€ api/                # API layer (Controllers in Clean Architecture)
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/         # Domain specific API handlers
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ kafka/      # Kafka-specific API handlers
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ rest/       # REST API handlers
â”‚   â”‚   â”‚   â””â”€â”€ sdk/            # Shared SDK components for domain
â”‚   â”‚   â”‚       â”œâ”€â”€ kconsumer/  # Kafka consumer components
â”‚   â”‚   â”‚       â”œâ”€â”€ kconsumermid/ # Kafka consumer middleware
â”‚   â”‚   â”‚       â””â”€â”€ mid/        # General middleware components
â”‚   â”‚   â”œâ”€â”€ app/                # Application layer (Use Cases in Clean Architecture)
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/         # Domain specific orchestration logic
â”‚   â”‚   â”‚   â”œâ”€â”€ errs/           # Error handling for the app layer
â”‚   â”‚   â”‚   â””â”€â”€ sdk/            # Shared SDK components for domain
â”‚   â”‚   â”œâ”€â”€ business/           # Domain layer (Entities in Clean Architecture)
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/         # Domain specific business logic
â”‚   â”‚   â”‚   â””â”€â”€ sdk/            # Shared SDK components for domain
â”‚   â”‚   â”œâ”€â”€ constant/           # Shared constants across the application
â”‚   â”‚   â”‚   â”œâ”€â”€ metakey/        # Metadata key constants
â”‚   â”‚   â”‚   â””â”€â”€ topic/          # Topic-related constants
â”‚   â”‚   â””â”€â”€ repository/         # Data access layer
â”‚   â”‚       â””â”€â”€ orm/            # Code generated by SQLBoiler
â”‚   â”œâ”€â”€ system/                 # System-wide common utilities
â”‚   â”‚   â”œâ”€â”€ admintoken/         # Admin token utilities
â”‚   â”‚   â”œâ”€â”€ idgenerator/        # ID generation utilities
â”‚   â”‚   â”œâ”€â”€ kafkaproducer/      # Kafka producer utilities
â”‚   â”‚   â”œâ”€â”€ order/              # Order-related utilities
â”‚   â”‚   â”œâ”€â”€ pagination/         # Pagination utilities
â”‚   â”‚   â”œâ”€â”€ redis/              # Redis integration utilities
â”‚   â”‚   â”‚   â””â”€â”€ lua/            # Lua scripts for Redis
â”‚   â”‚   â”œâ”€â”€ timeutil/           # Time utility functions
â”‚   â”‚   â”œâ”€â”€ validator/          # Validation utilities
â”‚   â”‚   â””â”€â”€ web/                # Web-related utilities
â”‚   â”œâ”€â”€ go.mod                  # Go module definition
â”‚   â”œâ”€â”€ go.sum                  # Go module checksums
â”‚   â”œâ”€â”€ local.env               # Environment configuration for local development
â”‚   â”œâ”€â”€ README.md               # API-specific documentation
â”‚   â””â”€â”€ sqlboiler.yaml          # SQLBoiler configuration
â”œâ”€â”€ build/                      # Build-related files
â”‚   â”œâ”€â”€ *.Dockerfile            # Docker build definitions
â”‚   â”œâ”€â”€ docker-compose.*.yaml   # Docker Compose configurations
â”‚   â”œâ”€â”€ Jenkinsfile.*.groovy    # Jenkins pipeline definitions
â”‚   â””â”€â”€ k8s/                    # Kubernetes configurations
â”‚       â”œâ”€â”€ base/               # Base Kubernetes manifests
â”‚       â”œâ”€â”€ dev/                # Development environment configs
â”‚       â”œâ”€â”€ qa/                 # QA environment configs
â”‚       â””â”€â”€ prod/               # Production environment configs
â”œâ”€â”€ .cursorignore               # Cursor editor ignore file
â”œâ”€â”€ .cursorrules                # Cursor AI rules file
â”œâ”€â”€ .gitignore                  # Git ignore file
â”œâ”€â”€ .golangci.toml              # Golangci-lint configuration
â”œâ”€â”€ LICENSE                     # Project license
â”œâ”€â”€ Makefile                    # Project-wide make targets
â”œâ”€â”€ README.md                   # Project documentation
â””â”€â”€ CODEOWNERS                  # Merge rights & auto reviewer assignment
```
### Additional guidance:
1. **New File Creation**:
   - When you need to create a new file, place it in the appropriate directory
   - api logic shall goes in `${PWD}/api/internal/api/domain/`
   - app logic shall goes in `${PWD}/api/internal/app/domain/`
   - business logic shall goes in `${PWD}/api/internal/business/domain/`
   - system-wide utilities common function shall goes in `${PWD}/api/system/`

2. **Root packages's dependency**:
   - executable binary root packages's dependency init function goes in `${PWD}/api/cmd/internal/components/`

3. **ORM layer**:
   - ORM code logic refer to `${PWD}/api/internal/repository/orm/`

4. **Testing**:
   - Test cases logic refer to `${PWD}/api/cmd/job/testcase/{job_name}/`

5. **When Uncertain**:
   - If uncertain about where to place a new file or directory, ask me in chat window:
     - What layer it belongs to

6. **Constants and Configs**:
   - Application-wide constants go in `${PWD}/api/internal/constant/`
   - Local development environment configurations find in `${PWD}/api/local.env`

### Subfolder rules:
- if you need to works on [README.md](mdc:README.md), please refer to `./cursor/rules/common/README.mdc`
- if you need to works on `*_test.go`, please refer to `./cursor/rules/test/*.mdc`
- if you need to works on `*.go` file, please refer to `./cursor/rules/business/*.mdc`


