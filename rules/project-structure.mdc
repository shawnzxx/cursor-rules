---
description: Project structure guidelines for file organization and architecture
alwaysApply: true
---
# Project Structure Guidelines

## Directory Tree
```
.
├── .githooks/                  # Git hooks for pre-commit and pre-push checks
├── api/                        # Backend code
│   ├── cmd/                    # Command layer - executable binary root packages
│   │   ├── serverd/            # Main API server binary
│   │   │   └── router/         # HTTP ingress routes
│   │   ├── job/                # Batch jobs binary
│   │   │   └── testcase/       # Test cases for jobs
│   │   ├── consumer/           # Consumer services binary
│   │   ├── banner/             # Banner related services binary
│   │   ├── producer/           # Producer services binary
│   │   ├── tooling/            # Development tools binary
│   │   │   ├── batch/          # Batch processing tools
│   │   │   └── logfmt/         # Log formatting utilities
│   │   └── internal/           # Shared internal components for cmd packages
│   │       └── components/     # Reusable initialization code
│   ├── data/                   # SQL files for direct DB manipulation
│   │   ├── migrations/         # Migration files for database schema changes
│   │   └── seed/               # Seeding data for local development
│   ├── internal/               # Internal application code
│   │   ├── api/                # API layer (Controllers in Clean Architecture)
│   │   │   ├── domain/         # Domain specific API handlers
│   │   │   │   ├── kafka/      # Kafka-specific API handlers
│   │   │   │   └── rest/       # REST API handlers
│   │   │   └── sdk/            # Shared SDK components for domain
│   │   │       ├── kconsumer/  # Kafka consumer components
│   │   │       ├── kconsumermid/ # Kafka consumer middleware
│   │   │       └── mid/        # General middleware components
│   │   ├── app/                # Application layer (Use Cases in Clean Architecture)
│   │   │   ├── domain/         # Domain specific orchestration logic
│   │   │   ├── errs/           # Error handling for the app layer
│   │   │   └── sdk/            # Shared SDK components for domain
│   │   ├── business/           # Domain layer (Entities in Clean Architecture)
│   │   │   ├── domain/         # Domain specific business logic
│   │   │   └── sdk/            # Shared SDK components for domain
│   │   ├── constant/           # Shared constants across the application
│   │   │   ├── metakey/        # Metadata key constants
│   │   │   └── topic/          # Topic-related constants
│   │   └── repository/         # Data access layer
│   │       └── orm/            # Code generated by SQLBoiler
│   ├── system/                 # System-wide common utilities
│   │   ├── admintoken/         # Admin token utilities
│   │   ├── idgenerator/        # ID generation utilities
│   │   ├── kafkaproducer/      # Kafka producer utilities
│   │   ├── order/              # Order-related utilities
│   │   ├── pagination/         # Pagination utilities
│   │   ├── redis/              # Redis integration utilities
│   │   │   └── lua/            # Lua scripts for Redis
│   │   ├── timeutil/           # Time utility functions
│   │   ├── validator/          # Validation utilities
│   │   └── web/                # Web-related utilities
│   ├── go.mod                  # Go module definition
│   ├── go.sum                  # Go module checksums
│   ├── local.env               # Environment configuration for local development
│   ├── README.md               # API-specific documentation
│   └── sqlboiler.yaml          # SQLBoiler configuration
├── build/                      # Build-related files
│   ├── *.Dockerfile            # Docker build definitions
│   ├── docker-compose.*.yaml   # Docker Compose configurations
│   ├── Jenkinsfile.*.groovy    # Jenkins pipeline definitions
│   └── k8s/                    # Kubernetes configurations
│       ├── base/               # Base Kubernetes manifests
│       ├── dev/                # Development environment configs
│       ├── qa/                 # QA environment configs
│       └── prod/               # Production environment configs
├── .cursorignore               # Cursor editor ignore file
├── .cursorrules                # Cursor AI rules file
├── .gitignore                  # Git ignore file
├── .golangci.toml              # Golangci-lint configuration
├── LICENSE                     # Project license
├── Makefile                    # Project-wide make targets
├── README.md                   # Project documentation
└── CODEOWNERS                  # Merge rights & auto reviewer assignment
```

## Guidance Rules for AI

1. **New File Creation**:
   - When creating files, place them in the appropriate directory according to their purpose and layer:
     - API/Controller code goes in `api/internal/api/domain/`
     - Application/Use Case logic goes in `api/internal/app/domain/`
     - Business/Entity logic goes in `api/internal/business/domain/`
     - System-wide utilities go in `api/system/`

2. **Domain Organization**:
   - Place domain-specific code in the corresponding domain directory within each layer
   - Use the SDK directories for shared components within that layer

3. **Command Layer Structure**:
   - All executable binaries should be placed in a subdirectory of `api/cmd/`
   - Shared initialization code goes in `api/cmd/internal/components/`

4. **Repository Access**:
   - Data access through ORM should use the generated code in `api/internal/repository/orm/`

5. **Testing**:
   - Test cases for jobs should go in `api/cmd/job/testcase/{job_name}/`

6. **Clean Architecture**:
   - Follow the [Clean Architecture](mdc:https:/blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html) principles with appropriate separation of concerns:
     - api layer = Controllers
     - app layer = Use Cases
     - business layer = Entities
     - repository = Data Access

7. **When Uncertain**:
   - If uncertain about where to place a new file or directory, ask for clarification by explaining:
     - The purpose of the file
     - What layer it belongs to
     - What domain it relates to

8. **Constants and Configs**:
   - Application-wide constants go in `api/internal/constant/`
   - Environment configurations go in `api/local.env` (for local development) 
